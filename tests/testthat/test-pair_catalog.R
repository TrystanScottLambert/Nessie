test_that("ids and idxs work in pair catalog", {
  ra = c(120., 120., 150., 130., 150., 30, 30, 30)
  dec = c(-45., -45., 0., 45., 0., 30, 30, 30)
  group_id = as.integer(c(1, 1, 2,-1, 2, 3, 3, 3))
  redshift = c(0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1)
  abmag = c(-18, -18, -18, -18, -18, -18, -18, -18)
  result = create_pair_catalog(ra, dec, redshift, abmag, group_id)
  answer_id = c(1, 2)
  answer_idx1 = c(1, 3)
  answer_idx2 = c(2, 5)
  expect_equal(result$pair_id, answer_id)
  expect_equal(result$idx_1, answer_idx1)
  expect_equal(result$idx_2, answer_idx2)
})
